- virsh.qemu_agent_command:
    type = virsh_qemu_agent_command
    start_vm = "no"
    vm_state = "running"
    variants:
        - normal_test:
            status_error = "no"
            variants:
                - valid_domname:
                    vm_ref = "domname"
                - valid_domid:
                    vm_ref = "domid"
                - valid_domuuid:
                    vm_ref = "domuuid"
            variants:
                - non_option:
                - timeout_option:
                    options = "--timeout 3"
                - pretty_option:
                    options = "--pretty"
                - async_option:
                    options = "--async"
                - block_option:
                    options = "--block"
            variants:
                - guest_info:
                    agent_cmd = "{"execute":"guest-info"}"
                - guest_sync:
                    variants:
                        - max_id:
                            agent_id = 9223372036854775807
                        - max_plus_one_id:
                            agent_id = 9223372036854775808
                        - min_id:
                            agent_id = -9223372036854775808
                        - min_minus_one_id:
                            agent_id = -9223372036854775809
                        - normal_id:
                            agent_id = 123456
                        - string_id:
                            agent_id = "'123456'"
                    variants:
                        - sync:
                            agent_cmd = "{"execute":"guest-sync", "arguments": { "id": ${agent_id} } }"
                        - sync_extra:
                            agent_cmd = "{"execute":"guest-sync", "arguments": { "id": ${agent_id} , "xyz":2} }"
                - guest_shutdown:
                    agent_cmd = "{"execute":"guest-shutdown"}"
        - error_test:
            status_error = "yes"
            variants:
                - invalid_options:
                    variants:
                        - invalid_domname:
                            vm_ref = "not_exist_xyz"
                        - invalid_domid:
                            vm_ref = "9999"
                        - hex_domid:
                            vm_ref = "hex_id"
                        - invalid_domuuid:
                            vm_ref = "99999999-9999-9999-9999-999999999999"
                        - none_domname:
                            vm_ref = ""
                        - invalid_options:
                            options = "--xyz"
                        - invalid_cmd:
                            agent_cmd = "fail me"
                        - guest_sync_invalid:
                            variants:
                                - float_id:
                                    agent_id = 1.1
                                - not_integer_id:
                                    agent_id = 01
                                - normal_id:
                                    no sync
                                    agent_id = 123456
                            variants:
                                - sync:
                                    agent_cmd = "{"execute":"guest-sync", "arguments": { "id": ${agent_id} } }"
                                - sync_no_id:
                                    only normal_id
                                    agent_cmd = "{"execute":"guest-sync", "arguments": {} }"
                                - sync_xyz:
                                    only normal_id
                                    agent_cmd = "{"execute":"guest-sync", "arguments": { "xyz": ${agent_id} } }"
                                - sync_argument:
                                    only normal_id
                                    agent_cmd = "{"execute":"guest-sync", "argument": { "id": ${agent_id} } }"
                - vm_shutoff:
                    vm_ref = "domname"
                    vm_state = "shut off"
                - vm_paused:
                    vm_ref = "domname"
                    vm_state = "paused"
                - no_ga:
                    vm_ref = "domname"
                    needs_agent = "no"

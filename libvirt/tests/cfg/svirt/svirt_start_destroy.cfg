- svirt_start_destroy:
    type = svirt_start_destroy
    start_vm = no
    kill_vm = yes
    kill_vm_gracefully = yes
    kill_vm_on_error = yes
    # Label for VM.
    svirt_start_destroy_vm_sec_label = "system_u:system_r:svirt_t:s0:c87,c520"
    svirt_start_destroy_host_selinux = "enforcing"
    variants:
        - with_qemu_conf:
            security_driver = 'none'
            variants:
                - no_sec_model:
                    no_sec_model = 'yes'
                - default_sec_model:
        - without_qemu_conf:
    variants:
        - sec_type_dynamic:
            svirt_start_destroy_vm_sec_type = "dynamic"
        - sec_type_static:
            no no_sec_model
            svirt_start_destroy_vm_sec_type = "static"
        - sec_type_none:
            no no_sec_model
            svirt_start_destroy_vm_sec_type = "none"
    variants:
        - sec_relabel_no:
            only without_qemu_conf..sec_type_static, without_qemu_conf..sec_type_none, default_sec_model..sec_type_static, default_sec_model..sec_type_none
            svirt_start_destroy_vm_sec_relabel = no
        - sec_relabel_yes:
            no sec_type_none
            svirt_start_destroy_vm_sec_relabel = yes
    variants:
        - disk_label_virt_content:
            no no_sec_model, sec_type_none
            svirt_start_destroy_disk_label = "system_u:object_r:virt_content_t:s0"
        - disk_label_svirt_image_s0:
            svirt_start_destroy_disk_label = "system_u:object_r:svirt_image_t:s0"
        - disk_label_svirt_image_MCS1:
            no no_sec_model, sec_type_none
            svirt_start_destroy_disk_label = "system_u:object_r:svirt_image_t:s0:c87,c520"
    variants:
        - poweroff_with_destroy:
            svirt_start_destroy_vm_poweroff = "destroy"
        - poweroff_with_shutdown:
            no sec_type_none, with_qemu_conf
            svirt_start_destroy_vm_poweroff = "shutdown"
    variants:
        - positive_test:
            status_error = no
            no sec_relabel_no..disk_label_virt_content, with_qemu_conf..default_sec_model
        - negative_test:
            # only when seclabel of VM is not relabeled and
            # img is labeld with "system_u:object_r:virt_content_t:s0",
            # VM will not be able to access image.
            status_error = yes
            only sec_relabel_no..disk_label_virt_content, with_qemu_conf..default_sec_model

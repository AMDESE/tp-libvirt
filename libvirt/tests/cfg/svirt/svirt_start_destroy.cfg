- svirt_start_destroy:
    type = svirt_start_destroy
    start_vm = no
    kill_vm = yes
    kill_vm_gracefully = yes
    kill_vm_on_error = yes
    # Label for VM.
    svirt_start_destroy_vm_sec_label = "system_u:system_r:svirt_t:s0:c87,c520"
    svirt_start_destroy_host_selinux = "enforcing"
    variants:
        - with_qemu_conf:
            variants:
                - security_driver_none:
                    security_driver = 'none'
                - unconfined:
                    security_default_confined = 0
                - required_confined:
                    security_require_confined = 1
        - without_qemu_conf:
    variants:
        - no_sec_model:
            no_sec_model = 'yes'
        - multiple_sec_model:
            svirt_start_destroy_vm_sec_model = "selinux,dac"
        - default_sec_model:
    variants:
        - sec_type_dynamic:
            svirt_start_destroy_vm_sec_type = "dynamic"
        - sec_type_static:
            no no_sec_model
            svirt_start_destroy_vm_sec_type = "static"
        - sec_type_none:
            no no_sec_model
            svirt_start_destroy_vm_sec_type = "none"
    variants:
        - sec_relabel_no:
            svirt_start_destroy_vm_sec_relabel = no
        - sec_relabel_yes:
            no sec_type_none, multiple_sec_model
            svirt_start_destroy_vm_sec_relabel = yes
    variants:
        - disk_label_virt_content:
            no no_sec_model, sec_type_none
            svirt_start_destroy_disk_label = "system_u:object_r:virt_content_t:s0"
        - disk_label_svirt_image_s0:
            svirt_start_destroy_disk_label = "system_u:object_r:svirt_image_t:s0"
        - disk_label_svirt_image_MCS1:
            no no_sec_model, sec_type_none
            svirt_start_destroy_disk_label = "system_u:object_r:svirt_image_t:s0:c87,c520"
    variants:
        - poweroff_with_destroy:
            svirt_start_destroy_vm_poweroff = "destroy"
        - poweroff_with_shutdown:
            no no_sec_model, sec_type_none, with_qemu_conf
            svirt_start_destroy_vm_poweroff = "shutdown"
    variants:
        - positive_test:
            status_error = no
            no default_sec_model..sec_type_dynamic..sec_relabel_no, multiple_sec_model..sec_type_dynamic..sec_relabel_no, multiple_sec_model..sec_type_static..sec_relabel_no, sec_relabel_no..sec_type_dynamic..no_sec_model
            no sec_relabel_no..disk_label_virt_content, security_driver_none..default_sec_model, security_driver_none..multiple_sec_model..sec_type_none, unconfined..sec_relabel_yes, sec_type_dynamic..multiple_sec_model..unconfined, sec_type_static..multiple_sec_model..unconfined, required_confined
        - negative_test:
            # only when seclabel of VM is not relabeled and
            # img is labeld with "system_u:object_r:virt_content_t:s0",
            # VM will not be able to access image.
            status_error = yes
            no sec_relabel_no..sec_type_dynamic, poweroff_with_shutdown..disk_label_virt_content, sec_type_dynamic..without_qemu_conf, sec_relabel_yes..sec_type_static..unconfined, sec_relabel_yes..sec_type_dynamic..unconfined, sec_relabel_yes..sec_type_static..without_qemu_conf, disk_label_virt_content..required_confined
            only default_sec_model..disk_label_virt_content, default_sec_model..security_driver_none, security_driver_none..multiple_sec_model..sec_type_none, sec_type_none..required_confined
